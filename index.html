<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Què toca tirar avui?</title>

    <!-- Tipografia moderna -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #f1f8e9;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 25px;
            border-radius: 18px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
            animation: fadeIn 0.4s ease-out;
        }

        h1 {
            color: #2e7d32;
            font-size: 2em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        #date {
            font-weight: 600;
            color: #1b5e20;
        }

        #message p {
            background: #e8f5e9;
            padding: 14px;
            border-radius: 12px;
            border-left: 6px solid #66bb6a;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .date-picker {
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }

        label {
            font-weight: 600;
            color: #33691e;
        }

        input[type="date"] {
            padding: 10px 14px;
            border-radius: 10px;
            border: 1px solid #bbb;
            font-size: 1em;
            margin-top: 8px;
        }

        /* MISSATGE DEL DIA — ICONES + FLETXA */
        .bin {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 35px;
        }

        .bin img {
            width: 80px;
            height: auto;
        }

        .arrow {
            font-size: 2.4em;
            font-weight: bold;
            color: #33691e;
            transition: transform 0.3s ease;
        }

        .bin:hover .arrow {
            transform: translateX(6px);
        }

        /* RESUM EN TARGETES */
        #summary {
            margin-top: 35px;
        }

        #summary h2 {
            margin-bottom: 15px;
            color: #2e7d32;
        }

        #cards {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .card {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .card img {
            width: 50px;
            height: auto;
        }

        .card-info {
            display: flex;
            flex-direction: column;
            font-size: 0.95em;
        }

        .card-title {
            font-weight: 600;
            color: #33691e;
            margin-bottom: 2px;
        }

        @media (max-width: 480px) {
            .container {
                padding: 18px;
            }

            h1 {
                font-size: 1.6em;
            }

            #message p {
                font-size: 1em;
            }

            .bin img {
                width: 60px;
            }

            .arrow {
                font-size: 2em;
            }

            .card img {
                width: 40px;
            }

            .card-info {
                font-size: 0.9em;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Què toca tirar avui a Montilivi?</h1>
        <p>Avui és <span id="date"></span></p>
        <div id="message"></div>

        <div class="date-picker">
            <label for="day-select">Tria un dia:</label><br>
            <input type="date" id="day-select" name="day-select">
        </div>

        <div id="summary"></div>
    </div>

    <script>
        /* DATES MONTILIVI 2026 */
        const montiliviDates = [
            "2026-01-13","2026-02-10","2026-03-10","2026-03-24","2026-04-07",
            "2026-04-21","2026-05-05","2026-05-19","2026-06-02","2026-06-09",
            "2026-06-16","2026-06-30","2026-07-14","2026-07-28","2026-08-11",
            "2026-08-25","2026-09-08","2026-09-22","2026-10-06","2026-10-20",
            "2026-11-17"
        ];

        function getNextWeekday(startDate, weekdays) {
            const date = new Date(startDate);
            while (!weekdays.includes(date.getDay())) {
                date.setDate(date.getDate() + 1);
            }
            return date;
        }

        function getNextMontilivi(startDate) {
            const iso = d => d.toISOString().split("T")[0];
            const startISO = iso(startDate);
            for (const d of montiliviDates) {
                if (d >= startISO) return new Date(d);
            }
            return null;
        }

        function getNextQuinzenal(startDate) {
            const ref = new Date(2025, 2, 23);
            const date = new Date(startDate);
            while (true) {
                if (date.getDay() === 0) {
                    const diff = Math.floor((date - ref) / (1000*60*60*24));
                    if (Math.floor(diff / 7) % 2 === 0) return date;
                }
                date.setDate(date.getDate() + 1);
            }
        }

        function formatDate(d) {
            return d.toLocaleDateString("ca-CA", {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
        }

        function daysBetween(a, b) {
            return Math.ceil((b - a) / (1000*60*60*24));
        }

        function updateSummary() {
            const today = new Date();

            const fractions = [
                { name: "Orgànic", icon: "organic.png", next: getNextWeekday(today, [1,3,5]) },
                { name: "Envasos", icon: "envasos.png", next: getNextWeekday(today, [1,5]) },
                { name: "Paper / Cartró", icon: "paper.png", next: getNextWeekday(today, [3]) },
                { name: "Vidre", icon: "vidre.png", next: getNextQuinzenal(today) },
                { name: "Resta", icon: "resta.png", next: getNextQuinzenal(today) },
                { name: "Restes vegetals", icon: "restesvegetals.png", next: getNextMontilivi(today) },
				{ name: "Tota aquesta panda d'inútils ", icon: "lluc.png", next: new Date("2027-05-23") }
            ];

            let html = `<h2>Properes recollides</h2><div id="cards">`;

            fractions.forEach(f => {
                if (!f.next) return;
                const days = daysBetween(today, f.next);

                html += `
                    <div class="card">
                        <img src="${f.icon}">
                        <div class="card-info">
                            <span class="card-title">${f.name}</span>
                            <span>${f.next.toLocaleDateString("ca-CA", { weekday: 'long' })}</span>
                            <span>${f.next.toLocaleDateString("ca-CA")}</span>
                            <span>Falten ${days} dies</span>
                        </div>
                    </div>
                `;
            });

            html += `</div>`;

            document.getElementById("summary").innerHTML = html;
        }

        /* MISSATGE DEL DIA */
        function getGarbageCollectionMessage(date) {
            const today = date ? new Date(date) : new Date();
            const isoDate = today.toISOString().split("T")[0];
            const dayOfWeek = today.getDay();

            // DIMARTS — RESTES VEGETALS
            if (dayOfWeek === 2) {
                if (montiliviDates.includes(isoDate)) {
                    return `
                        <p>Avui recullen les restes vegetals.</p>
                        <div class="bin">
                            <img src="restesvegetals.png">
                            <span class="arrow">→</span>
                            <img src="cub240.png">
                        </div>
                    `;
                } else return "<p>Avui no passen.</p>";
            }

            // DIJOUS I DISSABTE
            if ([4, 6].includes(dayOfWeek)) return "<p>No hi ha recollida d'escombraries</p>";

            // DILLUNS I DIVENDRES — ORGÀNIC + ENVASOS
            if (dayOfWeek === 1 || dayOfWeek === 5) {
                return `
                    <p>Hi ha recollida d´orgànic i envasos.</p>

                    <div class="bin">
                        <img src="organic.png">
                        <span class="arrow">→</span>
                        <img src="cubellmarro.png">
                    </div>

                    <div class="bin">
                        <img src="envasos.png">
                        <span class="arrow">→</span>
                        <img src="cubellblanc.png">
                    </div>
                `;
            }

            // DIMECRES — ORGÀNIC + PAPER
            if (dayOfWeek === 3) {
                return `
                    <p>Hi ha recollida d´orgànic i paper/cartró.</p>

                    <div class="bin">
                        <img src="organic.png">
                        <span class="arrow">→</span>
                        <img src="cubellmarro.png">
                    </div>

                    <div class="bin">
                        <img src="paper.png">
                        <span class="arrow">→</span>
                        <img src="cubellblanc.png">
                    </div>
                `;
            }

            // DIUMENGE — VIDRE + RESTA (QUINZENAL)
            if (dayOfWeek === 0) {
                const ref = new Date(2025, 2, 23);
                const diff = Math.floor((today - ref) / (1000*60*60*24));
                if (Math.floor(diff / 7) % 2 === 0) {
                    return `
                        <p>Hi ha recollida de vidre i resta.</p>

                        <div class="bin">
                            <img src="vidre.png">
                            <span class="arrow">→</span>
                            <img src="cubellmarro.png">
                        </div>

                        <div class="bin">
                            <img src="resta.png">
                            <span class="arrow">→</span>
                            <img src="cubellblanc.png">
                        </div>
                    `;
                } else return "<p>Avui no passen</p>";
            }

            return "<p>Avui no recullen escombraries</p>";
        }

        function updateMessage() {
            const selectedDate = document.getElementById("day-select").value;

            if (selectedDate) {
                document.getElementById("date").innerText = formatDate(new Date(selectedDate));
                document.getElementById("message").innerHTML = getGarbageCollectionMessage(selectedDate);
            }

            updateSummary(); // sempre des d’avui
        }

        document.getElementById("day-select").addEventListener("change", updateMessage);

        document.getElementById("date").innerText = formatDate(new Date());
        document.getElementById("message").innerHTML = getGarbageCollectionMessage();
        updateSummary();
    </script>
</body>
</html>
